/* status-bar v4.0.0-1 | (c) 2013 Support Time Limited. | http://www.apache.org/licenses/LICENSE-2.0.html */if(!jQuery.support.cors&&jQuery.ajaxTransport&&window.XDomainRequest){var httpRegEx=/^https?:\/\//i,getOrPostRegEx=/^get|post$/i,sameSchemeRegEx=new RegExp("^"+location.protocol,"i"),htmlRegEx=/text\/html/i,jsonRegEx=/\/json/i,xmlRegEx=/\/xml/i;jQuery.ajaxTransport("text html xml json",function(a,b){if(a.crossDomain&&a.async&&getOrPostRegEx.test(a.type)&&httpRegEx.test(a.url)&&sameSchemeRegEx.test(a.url)){var c=null,d=(b.dataType||"").toLowerCase();return{send:function(e,f){c=new XDomainRequest,/^\d+$/.test(b.timeout)&&(c.timeout=b.timeout),c.ontimeout=function(){f(500,"timeout")},c.onload=function(){var a="Content-Length: "+c.responseText.length+"\r\nContent-Type: "+c.contentType,b={code:200,message:"success"},e={text:c.responseText};try{if("html"===d||htmlRegEx.test(c.contentType))e.html=c.responseText;else if("json"===d||"text"!==d&&jsonRegEx.test(c.contentType))try{e.json=jQuery.parseJSON(c.responseText)}catch(g){b.code=500,b.message="parseerror"}else if("xml"===d||"text"!==d&&xmlRegEx.test(c.contentType)){var h=new ActiveXObject("Microsoft.XMLDOM");h.async=!1;try{h.loadXML(c.responseText)}catch(g){h=void 0}if(!h||!h.documentElement||h.getElementsByTagName("parsererror").length)throw b.code=500,b.message="parseerror","Invalid XML: "+c.responseText;e.xml=h}}catch(i){throw i}finally{f(b.code,b.message,e,a)}},c.onprogress=function(){},c.onerror=function(){f(500,"error",{text:c.responseText})};var g="";b.data&&(g="string"===jQuery.type(b.data)?b.data:jQuery.param(b.data)),c.open(a.type,a.url),c.send(g)},abort:function(){c&&c.abort()}}}})}!function(a,b){"use strict";b.SorryAPI=function(c){var d=this;d.options=a.extend({},SorryAPI.DEFAULTS,b.SorryAPIOptions,c)},SorryAPI.DEFAULTS={host:"https://ro-api.sorryapp.com",version:1},SorryAPI.prototype.endpoint_url=function(){var a=this;return a.options.host+"/v"+a.options.version},SorryAPI.prototype.fetchPage=function(b,c){var d=this,e=d.endpoint_url()+"/pages/"+b;return a.ajax({type:"GET",crossDomain:!0,dataType:"json",url:e,headers:{"X-Plugin-Ping":"status-bar"},data:{include:"brand,notices,notices.updates",subscriber:d.options.subscriber},success:c})}}(jQuery,window,document),function(a,b){"use strict";var c=function(a,b,c){var d=this;d.attributes=b,d.update=c,d.parent=a,d.template='<div class="sorry-status-notice" id="sorry-status-notice-{{id}}" role="alert">			<button type="button" class="sorry-status-notice-close" data-dismiss="status-notice" aria-hidden="true"><i class="sorry-status-notice-icon sorry-status-notice-icon-times-circle"></i></button>						<div class="sorry-status-notice-content">				<h4 class="sorry-status-notice-header"><i class="sorry-status-notice-icon sorry-status-notice-icon-bullhorn"></i> Ongoing</h4>				<p class="sorry-status-notice-text">{{notice}}</p>				<a class="sorry-status-notice-link" href="{{link}}" target="_blank" title="Visit our Status Page for more information.">More &#8594;</a>			</div>		</div>',d.frag="",d.buildFrag()};c.prototype.dismiss=function(a){var c=this;a.preventDefault(),c.parent.dismissed[c.attributes.id]=new Date,b.localStorage.setItem("sorry-status-bar",JSON.stringify(c.parent.dismissed)),c.$elem.remove()},c.prototype.buildFrag=function(){var a=this;a.frag+=a.template.replace(/{{notice}}/gi,a.update.content).replace(/{{link}}/gi,a.attributes.link).replace(/{{id}}/gi,a.attributes.id)},c.prototype.display=function(){var b=this;b.$elem=a(b.frag),b.parent.$elem.prepend(b.$elem),b.$elem.find('[data-dismiss="status-notice"]').bind("click.dismiss.status-notice",a.proxy(this.dismiss,this))};var d=function(c,d){var e=this;e.elem=d,e.$elem=a(d),e.options=c,e.api=new SorryAPI,e.dismissed=JSON.parse(b.localStorage.getItem("sorry-status-bar"))||{}};d.prototype.init=function(){var a=this;a.api.fetchPage(a.options.statusBarFor||a.options["status-bar-for"],function(b){a.loadcss(),a.set_style(b.response.brand),a.render(b.response.notices)})},d.prototype.render=function(b){var d=this,e=a.grep(b,function(a){return"open"==a.state});a.each(e,function(b,e){if(d.dismissed.hasOwnProperty(e.id))a.each(e.updates.reverse(),function(a,b){if(b.created_at>d.dismissed[e.id]){var f=new c(d,e,b);return f.display(),!1}});else{var f=new c(d,e,e.updates[e.updates.length-1]);f.display()}})},d.prototype.set_style=function(b){var c=" 			.sorry-status-bar { 				background-color: {{background_color}};			} 			.sorry-status-notice-header, .sorry-status-notice-text {				color: {{text_color}}; 			}			.sorry-status-notice-link, .sorry-status-notice-link:hover { 				color: {{link_color}}; 			} 			.sorry-status-notice-close, .sorry-status-notice-close:hover { 				color: {{text_color}}; 			} 		",d=b.color_header_background,e=b.color_header_text,f=b.color_header_links,g=b.color_state_warning,h=c.replace(/{{text_color}}/gi,e).replace(/{{background_color}}/gi,d).replace(/{{link_color}}/gi,f).replace(/{{state_warning_color}}/gi,g);a("head").append("<style>"+h+"</style>")},d.prototype.loadcss=function(){var b=this,c=a("<link/>",{rel:"stylesheet",type:"text/css",href:b.getpath()+"status-bar.min.css"});a("link").length?a(a("link")[0]).before(c):c.appendTo(a("head"))},d.prototype.getpath=function(){var b=a('script[src$="status-bar.min.js"]')[0];return b.src.split("?")[0].split("/").slice(0,-1).join("/")+"/"};var e=a.fn.statusBar;a.fn.statusBar=function(b){return this.each(function(){var c=new d(b,this);a.data(this,"statusBar",c)})},a.fn.statusBar.noConflict=function(){return a.fn.statusBar=e,this},a.fn.statusBar.setup=function(){var b=a('script[src$="status-bar.min.js"]')[0].getAttribute("data-for");b&&a(b.split(",")).each(function(){0===a('[data-status-bar-for="'+this+'"]').length&&a("body").prepend('<div class="sorry-status-bar" data-status-bar-for="'+this+'"></div>')})},a(b).bind("load",function(){a.fn.statusBar.setup(),a("[data-status-bar-for]").each(function(){var b=a(this);b.statusBar(b.data()),b.data("statusBar").init()})})}(jQuery,window,document);